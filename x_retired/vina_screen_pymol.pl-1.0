#!/usr/bin/perl -w

###################
#
#	Peter M.U. Ung @ MSSM
#
#	v1.0	- 13.10.22	
#
#	Using the [top result file] generated by vina_screen_get_top.py to
#	aggegrate the top pdbqt files into a PyMOL session
#
#	Required:	vina_screen_preprocess.py
#			vina_screen_get_top.py
#			
###################
die "\n    Usage: x.pl [Top result file] [Output NUM] [Protein pdb]\n\n"
  unless @ARGV == 3;

@data = ();
open IN, "< $ARGV[0]";
while (<IN>) {
  next if /#/;
  @_ = split;
  push @data, $_[1];
}
close IN;

open OUT, "> $ARGV[0].pml";
print OUT "load ".$ARGV[2]."\n";
for ($i = 0; $i <= $#data; $i++) { print OUT "load ".$data[$i]."\n" }
print OUT "hide lines, poly\n";
print OUT "set line_width, 4\n";
print OUT "show cartoon, poly\n";
print OUT "set transparency, 0.1\n";
print OUT "show surface, poly\n";
print OUT "color cyan, poly\n";
print OUT "center poly\n zoom poly\n";
print OUT "save ".$ARGV[0].".pse\nquit\n";
close OUT;

system("pymol -c ".$ARGV[0].".pml");
