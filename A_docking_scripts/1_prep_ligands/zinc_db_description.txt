# 3D, normal, in-stock, mild/reference pH, (drug-like)
# MW  376 - 499
# lgP -1 / 5
# 6.0K (after `sort --random-sort`: 5,986,247)
# 2019.07.28


# steps
from zinc15, downloaded the tranches. Each tranches are separated so have to
be combined into a main file (~ 412 MB in .smi). The smi file is shuffled and
divided into 75 sub-files for processing. (~80,000 in each individual .smi)

** one issue with these smilse files -- the first line is always missing some
characters, rendering the first line (molecule) of all smiles files to be bad
and any conversion will fail. But that only affect 75 molecules out of ~ 6M,
ignore for now.



############################################################################
## 19.03.22

downloaded newest ZINC15 molecules
- fragment-like (default)
- standard (default)
- in-stock
- charge (default)
- 3D (whichever gives more)

got ~ 813,920 molecules in SDF format, converted to SMILES with OBabel
and shuffled with 'sort' to randomize the order.
Divided into 20 files each 40,696 molecules of SMILES with Schrodinger
but stop it from running complete ligprep:

> para_ligprep -i ...

Generate .maegz with 2,917 failed molecules (drop.mae.smi)
No PAINS/reactive/aggregator filter, OPLS3e, 1 conformer, most populous
1 tautomoer at pH 7.2+/-0.3 (cytosol pH)
> time ${SCHRODINGER}/ligprep -WAIT -LOCAL \
        -i 2   -epik -We,-ph,7.2,-pht,0.3,-ms,1 \
        -s 1   -t 1 \
        -bff   16 \
#        -f $homedir/all-1.sch.propt_filter.cflt \
        -ismi  $homedir/SDIN.smi \
#       -isd   /sc/orga/projects/schlea02a/8_lib/zinc_lead13/glide/SDIN.sch.sdf.gz \
        -omae  SDIN.maegz \
        -HOST  localhost:$schcpu \
        -NJOBS $schnjob


###########################################################################
# 3D, clean, in-stock, mild/reference pH, -2,-1,0,+1,+2, fragment
# MW     / 250
# lgP -1 / 3.5
# 458K (457,642)
# 25 May 2016

## MW   /375
# lgP -1/4.0
#
** apparently the zinc15 fragment set downloaded back in 15.12.31 has lots of
   non-Now compounds included, even though 'in-stock' setting was used (2.3 M)
   so now I need to redo the entire dataset here.

# steps
from zinc15, downloaded the tranches. Each tranches are separated so have to
be combined into a main file (~ 194 MB in .smi). The smi file is shuffled and
divided into 25 sub-files for processing.
  > 3,278,207 (~120,000 in each individual .smi)

Assume the charge, tautomer, and chiral center generated by ZINC15 is bad,
NO 'flipper' was used to generate all chiral centers; too much.
  > 3,278,207

Canvas: "structure filter" has 'issue with 3D structures without sanitization',
  has to run ligprep first to clean up and prepare (*.prep.*) the structures:

    > ligprep -i 2 -epik -W e,-ph,7.2,-pht,0.3,-ms,1 -s 1 -r 1 -t 1 -bff 16
                   -isd input.sdf.gz -osd output.sdf.gz -HOST localhost:8

    > 3,276,734 (779 failed)

Canvas: "structure filter" to filter out reactives, undesirable groups, PAINS:

  > $SCHRODINGER/utilities/canvasSearch -isd input.sdf.gz -osd output.sdf.gz
                -osd2 output.fail.sdf.gz -filter -file all-1.sch.pains.cflt
  > ** glide/
  > 3,005,421 (271,313 failed)

all-1.sch.pains.cflt is the filter file with SMARTS strings of functionalities
to be screened. A few parameters for functional group are changed.
* Carboxylic acid, 1 -> 3/4

## 2017.07.18
Found out that the PAINS filters may filter out some of the non-PAIN compounds
if the compounds contain functional group(s) matches the SMARTS string. e.g.
ZINC11117465, which is tested stable, but the imine-like functional group in
1,3,4-imidizole group is flagged down and excluded in the output.

Best approach to deal with this is to generate a screening file with all failed
ligands and screen separately from the cleaned set, and evaluated as needed.


###########################################
# 26 May 2016
#
OpenEye: normally with fixpka, omega2

# steps
usually would use "fixpka" to find the best tautomer state at pH 7. However,
since we are moving away from OpenEye due to future patent issues, we switched
to Schrodinger to complete the "tautomer" determination and "PAINs" filtering.

From the Schrodinger-filtered libraries, use omega2 to regenerate 3D structures
with MMFF94s force field for OpenEye.

  > ** fred/
  > 3,005,402 (19 failed)

# 17.07.21
Since with Glide I am going to use the filtered molecules as input again, same
should be done with FRED. From Schrodinger's failed molecule set, generate
the conformers of these PAINS-filtered molecules.

